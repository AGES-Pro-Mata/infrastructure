# Regras de Alertas de Segurança Pro-Mata
# Arquivo: security/alerts-rules.yml

alerts:
  # Alertas Críticos
  critical:
    - name: "container_privileged"
      description: "Container rodando em modo privilegiado"
      condition: "privileged_container_detected"
      action: "immediate_notification"
      
    - name: "critical_vulnerability"
      description: "Vulnerabilidade crítica encontrada"
      condition: "critical_cve_detected"
      action: "immediate_notification"
      
    - name: "ssl_expired"
      description: "Certificado SSL expirado"
      condition: "ssl_cert_expired"
      action: "immediate_notification"
      
    - name: "brute_force_attack"
      description: "Possível ataque de força bruta"
      condition: "failed_logins > 20 in 5min"
      action: "immediate_notification"

  # Alertas Altos
  high:
    - name: "high_vulnerability"
      description: "Vulnerabilidade alta encontrada"
      condition: "high_cve_detected"
      action: "notification_with_delay"
      
    - name: "suspicious_process"
      description: "Processo suspeito detectado"
      condition: "suspicious_binary_executed"
      action: "notification_with_delay"
      
    - name: "ssl_expiring_soon"
      description: "Certificado SSL expira em breve"
      condition: "ssl_cert_expires_in < 7days"
      action: "notification_with_delay"
      
    - name: "high_resource_usage"
      description: "Alto uso de recursos do sistema"
      condition: "cpu > 95% OR memory > 95% OR disk > 95%"
      action: "notification_with_delay"

  # Alertas Médios
  medium:
    - name: "medium_vulnerability"
      description: "Vulnerabilidade média encontrada"
      condition: "medium_cve_detected"
      action: "daily_summary"
      
    - name: "config_file_changed"
      description: "Arquivo de configuração crítico alterado"
      condition: "critical_file_modified"
      action: "notification_with_delay"
      
    - name: "unusual_network_activity"
      description: "Atividade de rede incomum"
      condition: "unexpected_connections OR new_listening_ports"
      action: "notification_with_delay"

  # Configurações de Ação
  actions:
    immediate_notification:
      channels: ["discord", "email", "slack"]
      delay: 0
      repeat: false
      
    notification_with_delay:
      channels: ["discord", "email"]
      delay: 300  # 5 minutos
      repeat: false
      
    daily_summary:
      channels: ["email"]
      delay: 0
      schedule: "0 8 * * *"  # 8h da manhã

# Configurações de Rate Limiting
rate_limiting:
  enabled: true
  rules:
    - alert_type: "critical"
      max_per_hour: 10
      max_per_day: 50
      
    - alert_type: "high"
      max_per_hour: 20
      max_per_day: 100
      
    - alert_type: "medium"
      max_per_hour: 50
      max_per_day: 200

# Configurações de Escalação
escalation:
  enabled: true
  rules:
    - condition: "critical_alerts > 5 in 1hour"
      action: "escalate_to_management"
      
    - condition: "system_compromise_detected"
      action: "emergency_response"
      
    - condition: "multiple_services_down"
      action: "escalate_to_oncall"
