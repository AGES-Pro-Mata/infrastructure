# Fail2ban Configuration - Pro-Mata Infrastructure
# Generated by Ansible

[DEFAULT]
# Ban time (in seconds)
bantime = 3600

# Find time window (in seconds) 
findtime = 600

# Number of failures before ban
maxretry = 3

# Destination email for notifications
destemail = {{ vault_acme_email | default('admin@promata.dev') }}

# Sender email
sender = fail2ban@{{ domain_name }}

# Action to take when IP is banned
action = %(action_mw)s

[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600

[nginx-http-auth]
enabled = false
port = http,https
filter = nginx-http-auth
logpath = /var/log/nginx/error.log

[nginx-limit-req]
enabled = false
port = http,https
filter = nginx-limit-req
logpath = /var/log/nginx/error.log

# Custom filter for Docker/Traefik if needed
[traefik-auth]
enabled = false
port = http,https
filter = traefik-auth
logpath = /var/log/traefik/access.log
maxretry = 5